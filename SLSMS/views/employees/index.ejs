<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link href="/images/favicon.ico" rel="shortcut icon" type="image/png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />
	
	
    <script src="https://code.jquery.com/jquery-1.12.4.js" type="text/javascript"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.bootstrap.min.css">
	
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<link rel="stylesheet" href="http://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css"></style>
	<script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
	
	<link href="/stylesheets/light-bootstrap-dashboard.css?v=1.4.0" rel="stylesheet" />
	 <link href="/stylesheets/bootstrap.min.css" rel="stylesheet" />

    <!-- Animation library for notifications   -->
	
	
    <link href="/stylesheets/animate.min.css" rel="stylesheet"/>
    <link href="/stylesheets/main.css" rel="stylesheet" />
    
	
	
</head>
<body>
    <div class="wrapper">
        <div class="sidebar" data-image/image/sidebar-5.jpg>
		      <div class="sidebar-wrapper">
		

                    <div class="logo">
                        <a target="_blank" href="http://www.safe-lanes.com" class="simple-text">
                            <img src="/images/SafeLanes_logo.png" class="imgclass" />
                        </a>
                    </div>
                    <ul class="nav">
                        <li>
                            <a href="/dashboard">
                               <p>Dashboard</p>
                            </a>
                        </li>
                       
						<li class="active">
                            <a href="/employees">
                               <p>Employee Master</p>
                            </a>
                        </li>
						
                        <li>
                            <a href="/vdranalysiss">
                                <p>VDR Job Tracker</p>
                            </a>
                        </li>
                        <li>
                            <a href="/jobassignments">
                               <p>Vessel Job Tracker</p>
                            </a>
                        </li>
						<li>
                            <a href="/clients">
                               <p>Client Details</p>
                            </a>
                        </li>
						<li>
                            <a href="/observationanalysis">
                               <p>Observation Analysis</p>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>

  <div class="main-panel" data-color="orange" >
        <nav class="navbar navbar-default navbar-fixed" >
            <div class="container-fluid">
	    <!--added new -->
	    	<div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#"></a>
                </div>
	   <!--added new -->
                <div  align="right">
                   <a href="">Account</a>
                   &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                   <a href="#">Log out</a>
                </div>
			   
            </div>
			
		</nav>
			
		
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h5><a href="/employees/create">Create Employee</a></h5>
                                 <h5>Employee List</h5>
                                
                            </div>
                            <div class="content table-responsive table-full-width">
							 <% if(employees.length>0) { %>
                                <table id="myTable" class="table table-striped" > 
                                    <thead>
									<tr>
									<th>Add Information</th>
									<th>EmployeeCode</th>
                                    <th>Employee Name</th>
                                    <th>Passport/IC No</th>
                                    <th>Nationality</th>
                                    <th>Work Permit</th>
                                    <th>Office</th>
									<th>Status</th>
									</tr>
                                </thead>
                               <tbody>
			
			                    <% for(var i=0; i<employees.length;i++) { %>
                                   <tr>
								     <td> <a data-toggle="modal" href="#myModal" class="pull-left"><img src='/images/Visa.png' title="Add Visa" align="left" hspace="5" onclick="callVisaemp('<%= employees[i].employee_id%>');"/></a>
									      <a data-toggle="modal" href="#bankModal" class="pull-left"><img src='/images/bank.png' title="Add Bank" align="left" hspace="5" onclick="callBankemp('<%= employees[i].employee_id%>');"/></a>
										 <a data-toggle="modal" href="#docModal" class="pull-left"><img src='/images/adddocs.png' title="Add Documents" align="left" hspace="5" onclick="callDocemp('<%= employees[i].employee_id%>');"/></a>
										 <a data-toggle="modal" href="#payslipModal" class="pull-left"><img src='/images/Payslip.png' title="Add Payslips" align="left" hspace="5" onclick="callPayslipemp('<%= employees[i].employee_id%>');"/></a>
                                    <td><a href="/employees/show/<%= employees[i]._id%>"><%= employees[i].employee_id%></a></td>
									<td><%= employees[i].firstname%> <%= employees[i].lastname%> </td>
                                    <td><%= employees[i].passportno%></td>
								    <td><%= employees[i].nationality%></td>
								    <td><%= employees[i].permitstatus%></td>
								    <td><%= employees[i].office%></td>
									<td><%= employees[i].status%></td>
                                  </tr>
                                <% } %>
							   </tbody>
                          </table>
                             <% } else { %>
                         <div class="header">No employees found.</div>
                               <% } %>
                         </div>
			
			
			
                         </div>
                        </div>
                    </div>
	                <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                     <div class="modal-dialog">
                     <div class="modal-content" >
                     <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">Visa Details</h4>
                     </div>
                     <div class="modal-body" style="height: 700px;overflow-y: auto;">
					 <form id ="visaemp" enctype="multipart/form-data" method="post" >
					 <input id="id1" type="hidden" name="id1" value=""/>
					 <input id="id2" type="hidden" name="id2" value=""/>
                     <div class="row">
                     <div class="col-md-12">
                        <div class="card">

                            <div class="container">
                                <div class="content">
                                   
			                          <div class="row">
                                       <div class="col-md-2">
                                         <div class="form-group">
                                           <label>Country *</label>
                                                  <select name="vcountry" class="form-control" id="vcountry" required>
												  <option value=''>Select Country</li>
								                   <% for(var i=0; i < country.length; i++){ %>
												        <option value='<%= country[i] %>'><%= country[i] %></li>
                                                   <% } %>
							                      </select>
									   </div>
                                   </div>
                                   <div class="col-md-2">
                                          <div class="form-group">
                                            <label>Date Of Expiry *</label>
                                            <input type="date" class="form-control" placeholder="Date Of Expiry" name="expirydate" id="expirydate" required>
										  </div>
										</div>
                                 </div>
								 <div class="row">
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label>Type Of Visa</label>
                                                <input type="text" class="form-control" placeholder="Type Of Visa" name="visatype" id="visatype" required>
                                            </div>
                                        </div>
                                 
								    <div class="col-md-2">
						               <div class="form-group">
                                           <label>Copy of Visa</label>
                                           <input type="file" class="form-control-file" name="visadoc" id="visadoc" required/>
										   
										   
                                       </div>
									</div>
						        </div>
								<font color='red'> <DIV id="une"> </DIV> </font>
								 <div class="row" >
								  <div class="col-md-2">
								  	 <input id="subbtn1" type="button" class="btn btn-info btn-fill pull-left" value ="Add Visa"/>					             
								  </div>
								 
								 </div>
								 <div class="clearfix"></div>
                                     
		                          
		                        </div>
							</div>
						</div>
					</div>
				</div>
				
				<div class="row">
                    <div class="col-md-12">
                        <div class="card">
						 <div class="content table-responsive table-full-width">
                            
                            <table class="table table-hover table-striped" id="tab1">
                                    <thead>
									<tr>
									<th>Country Of Visa</th>
									<th>Date Of Expiry</th>
									<th>Type Of Visa</th>
									<th>Visa Doc</th>
									<th>Action</th>
                                    </tr>
                                </thead>
                              
							</table>
                               
                        </div>							   
		               </div>
			        </div>
		        </div>
				</form>
              </div>
                     
        </div>

   
    </div>
</div>

<div class="modal fade" id="docModal" tabindex="-1" role="dialog" aria-labelledby="docModalLabel">
                     <div class="modal-dialog" role="document">
                     <div class="modal-content" >
                     <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="docModalLabel">Documents Upload</h4>
                     </div>
                      <div class="modal-body" style="height: 700px;overflow-y: auto;">
					  <form id ="docemp" enctype="multipart/form-data" method="post" >
					  <input id="id3" type="hidden" name="id3" value=""/>
					  <input id="id4" type="hidden" name="id4" value=""/>
                     <div class="row">
                     <div class="col-md-12">
                        <div class="card">

                            <div class="container">
                                <div class="content">
                                   
								   
			                          <div class="row">
                                       <div class="col-md-2">
                                         <div class="form-group">
                                           <label>Type of Documents *</label>
                                                  <select name="documenttype" class="form-control" id="documenttype" required>
								                   <% for(var i=0; i < documenttype.length; i++){ %>
								                   <option value='<%= documenttype[i]._id %>'><%= documenttype[i].name %></li>
                                                   <% } %>
							                      </select>
									   </div>
                                   </div>
								   <div class="col-md-2">
						               <div class="form-group">
                                           <label>Copy of Document</label>
                                           <input type="file" class="form-control-file" name="files[]" id ="cdoc" multiple/>
										   
										   
                                       </div>
									</div>
                                   
                                 </div>
								 <font color='red'> <DIV id="une1"> </DIV> </font>
								  <div class="row" >
								  <div class="col-md-2">
								  	 <input id="subbtn3" type="button" class="btn btn-info btn-fill pull-left" value ="Add Docs"/>					             
								  </div>
								 
								 </div>
								 <div class="clearfix"></div>
                                     
		                          
		                        </div>
							</div>
						</div>
					</div>
				</div>
				
				<div class="row">
                    <div class="col-md-12">
                        <div class="card">
						 <div class="content table-responsive table-full-width">
                            
                            <table class="table table-hover table-striped" id="tab2">
                                    <thead>
									<tr>
                                    <th>Type Of Document</th>
									<th>Name</th>
									<th>Action</th>
                                    </tr>
                                </thead>
                              
							</table>
                               
                        </div>							   
		               </div>
			        </div>
		        </div>
				</div>
                    </form> 
                    </div>
    </div>
</div>

<div class="modal fade" id="payslipModal" tabindex="-1" role="dialog" aria-labelledby="payslipModalLabel">
                     <div class="modal-dialog" role="document">
                     <div class="modal-content" >
                     <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="payslipModalLabel">PaySlip Upload</h4>
                     </div>
                      <div class="modal-body" style="height: 700px;overflow-y: auto;">
					  <form id ="payslipEmp" enctype="multipart/form-data" method="post" >
					  <input id="id7" type="hidden" name="id7" value=""/>
					  <input id="id8" type="hidden" name="id8" value=""/>
                     <div class="row">
                     <div class="col-md-12">
                        <div class="card">

                            <div class="container">
                                <div class="content">
                                   
								   
			                          <div class="row">
                                       <div class="col-md-2">
                                         <div class="form-group">
                                           <label>Year *</label>
                                                 <select name="year" class="form-control" id="year">
						                             <option value=''>Select</option>
													 <% for(var i=0; i < year.length; i++){ %>
														<option value='<%= year[i].name %>'><%= year[i].name %></li>
													 <% } %>
								        
												 </select>
									   </div>
                                   </div>
								   
								   <div class="col-md-2">
										<div class="form-group">
										  <label>Select Month</label>
											 <select name="month" class="form-control" id="month">
											   <option value=''>Select</option>
											   <option value="January">January</option>
											   <option value="February">February</option>
											   <option value="March">March</option>
											   <option value="April">April</option>
											   <option value="May">May</option>
											   <option value="June">June</option>
											   <option value="July">July</option>
											   <option value="August">August</option>
											   <option value="September">September</option>
											   <option value="October">October</option>
											   <option value="November">November</option>
											   <option value="December">December</option>
											 </select>
										</div>
								   </div>
								   </div>
								   <div class="row">
								   
								   <div class="col-md-2">
						               <div class="form-group">
                                           <label>Copy of PaySlips</label>
                                           <input type="file" class="form-control-file" name="files[]" id ="pdoc" multiple/>
										   
										   
                                       </div>
									</div>
                                   
                                 </div>
								 <font color='red'> <DIV id="une4"> </DIV> </font>
								 <div class="row" >
								  <div class="col-md-2">
								  	 <input id="subbtn5" type="button" class="btn btn-info btn-fill pull-left" value ="Add PaySlips"/>					             
								  </div>
								 
								 </div>
								 <div class="clearfix"></div>
		                          
		                        </div>
							</div>
						</div>
					</div>
				</div>
				
				<div class="row">
                    <div class="col-md-12">
                        <div class="card">
						 <div class="content table-responsive table-full-width">
                            
                            <table class="table table-hover table-striped" id="tab4">
                                    <thead>
									<tr>
                                    <th>Year</th>
									<th>Month</th>
									<th>Payslips</th>
									<th>Action</th>
                                    </tr>
                                </thead>
                              
							</table>
                               
                        </div>							   
		               </div>
			        </div>
		        </div>
				</div>
                    </form> 
                    </div>
    </div>
</div>

<div class="modal fade" id="bankModal" tabindex="-1" role="dialog" aria-labelledby="bankModalLabel">
                     <div class="modal-dialog" role="document">
                     <div class="modal-content" >
                     <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="bankModalLabel">Bank Details</h4>
                     </div>
                     <div class="modal-body" style="height: 700px;overflow-y: auto;">
					  <form id ="bankemp" method="post" >
					  <input id="id5" type="hidden" name="id5" value=""/>
					  <input id="id6" type="hidden" name="id6" value=""/>
					  <input id="idhd1" type="hidden" name="idhd1" value=""/>
                     <div class="row">
                     <div class="col-md-12">
                        <div class="card">

                            <div class="container">
                                <div class="content">
                                   <form role="form" id="newModalForm3">
								   
			                          <div class="row">
                                       <div class="col-md-2">
                                         <div class="form-group">
                                           <label>Bank Name *</label>
                                                <select name="bankname" class="form-control" id="bankname">
								                   <% for(var i=0; i < bank.length; i++){ %>
								                   <option value='<%= bank[i]._id %>'><%= bank[i].name %></li>
                                                   <% } %>
								                </select>
									   </div>
                                   </div>
								   <div class="col-md-2">
                                         <div class="form-group">
                                                <label>Address </label>
                                                <input type="text" class="form-control" placeholder="Address" name="baddress" id="baddress" required>
                                         </div>
                                   </div>
								   </div>
								   <div class="row">
								   <div class="col-md-2">
                                            <div class="form-group">
                                                <label>Swift/Sort Code *</label>
                                                <input type="text" class="form-control" placeholder="Swift/Sort Code" name="scode" id="scode" required>
                                            </div>
                                        </div>
										<div class="col-md-2">
                                            <div class="form-group">
                                                <label>IFSC Code *</label>
                                                <input type="text" class="form-control" placeholder="IFSC Code" name="ifsccode" id="ifsccode" required>
                                            </div>
                                        </div>
                                   
                                 </div>
								 <div class="row">
								 <div class="col-md-2">
                                            <div class="form-group">
                                                <label>Account Number *</label>
                                                <input type="text" class="form-control" placeholder="Account Number" name="accountno" id="accountno" required>
                                            </div>
                                        </div>
								 </div>
								 <font color='red'> <DIV id="une3"> </DIV> </font>
										 <div class="row" >
								  <div class="col-md-2">
								  	 <input id="subbtn7" type="button" class="btn btn-info btn-fill pull-left" value ="Add Account"/>					             
								  </div>
								
								 </div>
								 <div class="clearfix"></div>
                                     
		                          
		                        </div>
							</div>
						</div>
					</div>
				</div>
				
				<div class="row">
                    <div class="col-md-12">
                        <div class="card">
						 <div class="content table-responsive table-full-width">
                            
                            <table class="table table-hover table-striped" id="tab3">
                                    <thead>
									<tr>
                                    <th>Bank</th>
									<th>IFSC Code</th>
									<th>Account Number</th>
									<th>Action</th>
                                    </tr>
                                </thead>
                              
							</table>
                               
                        </div>							   
		               </div>
			        </div>
		        </div>
				
                     </div>
                     </form>
                    </div>
                    </div>
                </div>

</body>
</html>


<script>
function validatedoc(){
	if(document.getElementById("cdoc").files.length == 0)
	{
	      document.getElementById('une1').innerHTML = "Please upload file(s)";
		  document.getElementById("cdoc").focus();
		  return(false);
	}
	return true;
}

function validatepayslip(){
	
	
	
	if(document.getElementById("year").value == '')
	{
	      document.getElementById('une4').innerHTML = "Please select Year";
		  document.getElementById("year").focus();
		  return(false);
	}
	
	if(document.getElementById("month").value == '')
	{
	      document.getElementById('une4').innerHTML = "Please select Month";
		  document.getElementById("month").focus();
		  return(false);
	}
	
	if(document.getElementById("pdoc").files.length == 0)
	{
	      document.getElementById('une4').innerHTML = "Please upload payslip";
		  document.getElementById("pdoc").focus();
		  return(false);
	}
	return true;
}

function validatebank(){
	
	if(document.getElementById("scode").value=="")
	  {
	  document.getElementById('une3').innerHTML = "Swift/Sort code cannot be blank";
	  document.getElementById("expirydate").focus();
	  return(false);
	 }
     if(document.getElementById("ifsccode").value=="")
	  {
	  document.getElementById('une3').innerHTML = "IFSC code cannot be blank";
	  document.getElementById("ifsccode").focus();
	  return(false);
	 }
	 
	 if(document.getElementById("accountno").value=="")
	  {
	  document.getElementById('une3').innerHTML = "Account Number cannot be blank";
	  document.getElementById("accountno").focus();
	  return(false);
	 }
    return true;
	}
function validate(){
	if(document.getElementById("vcountry").value=='')
		 {
		  document.getElementById('une').innerHTML = "Please Select Country";
		  document.getElementById("vcountry").focus();
		  return(false);
		 }
	if(document.getElementById("visadoc").files.length == 0)
	{
	      document.getElementById('une').innerHTML = "Please upload file(s)";
		  document.getElementById("visadoc").focus();
		  return(false);
	}
	if(document.getElementById("expirydate").value == '')
		{
		  document.getElementById('une').innerHTML = "Please Select ExpiryDate";
		  document.getElementById("expirydate").focus();
		  return(false);
		}
		 return true;
		 
}
function callPayslipemp(employee_id){

document.getElementById("id7").value = employee_id;
document.getElementById("year").value='';
document.getElementById("month").value='';
document.getElementById("pdoc").value="";
document.getElementById('une4').innerHTML = ""; 		
 $.ajax(
    {
        type: "GET",
        url: "/employees/returnpayslipemp",
        data: { employee_id: employee_id ,
		        year:document.getElementById("year").value
				},
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        cache: false,
        success: function (payslipdoc) {
            
        
           successpaysliptbl(payslipdoc);
        
        },
       error: function (msg) {
            
            
        }
    });
   }
function callDocemp(employee_id){
document.getElementById("id3").value = employee_id;
document.getElementById('une1').innerHTML = ""; 
$('#cdoc').val(''); 
document.getElementById("documenttype").selectedIndex = 0;	
sortSelect(document.getElementById("documenttype"), 'text', 'asc'); 
	
 $.ajax(
    {
        type: "GET",
        url: "/employees/returndocemp",
        data: { employee_id: document.getElementById("id3").value },
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        cache: false,
        success: function (datadoc) {
            
        
           successdoctbl(datadoc);
        
        },
       error: function (msg) {
            
            
        }
    });
   }
  
function callBankemp(employee_id){
document.getElementById("id5").value = employee_id;
document.getElementById("bankname").selectedIndex = 0;
document.getElementById("baddress").value = "";	 
document.getElementById("scode").value = "";	 
document.getElementById("ifsccode").value = "";	 
document.getElementById("accountno").value = "";	
document.getElementById('une3').innerHTML = ""; 
sortSelect(document.getElementById("bankname"), 'text', 'asc'); 			
 $.ajax(
    {
        type: "GET",
        url: "/employees/returnbankemp",
        data: { employee_id: document.getElementById("id5").value },
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        cache: false,
        success: function (databank) {
            
        
           successbanktbl(databank);
        
        },
       error: function (msg) {
            
            
        }
    });
   }
function callVisaemp(employee_id){
document.getElementById("id1").value = employee_id;
document.getElementById("vcountry").value='';
document.getElementById("expirydate").value='';
document.getElementById("visatype").value="";
document.getElementById("visadoc").value="";
document.getElementById('une').innerHTML = ""; 		
 $.ajax(
    {
        type: "GET",
        url: "/employees/returnvisaemp",
        data: { employee_id: document.getElementById("id1").value },
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        cache: false,
        success: function (data1) {
            
         
           successtbl(data1);
        
        },
       error: function (msg) {
            
            
        }
    });
   }
  
$("#subbtn3").click(function (event) {
      if(validatedoc()){  
	    
        event.preventDefault();
        // Get form
        var form = $('#docemp')[0];
		// Create an FormData object
        var data = new FormData(form);
		
		// disabled the submit button
        
        $.ajax({
            type: "POST",
            enctype: 'multipart/form-data',
            url: "/employees/adddocemp",
            data: data,
            processData: false,
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (datadoc) {
           
            successdoctbl(datadoc);
       
        
            },
            error: function (e) {
                //$("#result").text(e.responseText);
                console.log("ERROR : ", e);
                
            }
        });
	  
	     
		  document.getElementById('une1').innerHTML = ""; 
          $('#cdoc').val(''); 
          document.getElementById("documenttype").selectedIndex = 0;		  
	  
	  }
	  
    });
	
	
	$("#subbtn5").click(function (event) {
      if(validatepayslip()){  
	    
        event.preventDefault();
        // Get form
        var form = $('#payslipEmp')[0];
		// Create an FormData object
        var data = new FormData(form);
		
		// disabled the submit button
        
        $.ajax({
            type: "POST",
            enctype: 'multipart/form-data',
            url: "/employees/addpayslipemp",
            data: data,
            processData: false,
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (data1) {
           
            successpaysliptbl(data1);
       
        
            },
            error: function (e) {
                //$("#result").text(e.responseText);
                console.log("ERROR : ", e);
                
            }
        });
	  
	     document.getElementById("year").value='';
		 document.getElementById("month").value='';
		 document.getElementById("pdoc").value="";
         document.getElementById('une4').innerHTML = ""; 		 
	  
	  }
	  
    });
	
	
	$("#subbtn1").click(function (event) {
      if(validate()){  
	    
        event.preventDefault();
        // Get form
        var form = $('#visaemp')[0];
		// Create an FormData object
        var data = new FormData(form);
		
		// disabled the submit button
        
        $.ajax({
            type: "POST",
            enctype: 'multipart/form-data',
            url: "/employees/addvisaemp",
            data: data,
            processData: false,
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (data1) {
           
            successtbl(data1);
       
        
            },
            error: function (e) {
                //$("#result").text(e.responseText);
                console.log("ERROR : ", e);
                
            }
        });
	  
	     document.getElementById("vcountry").value='';
		 document.getElementById("expirydate").value='';
		 document.getElementById("visatype").value="";
		 document.getElementById("visadoc").value="";
         document.getElementById('une').innerHTML = ""; 		 
	  
	  }
	  
    });
	$("#subbtn7").click(function (event) {
    
      if(validatebank()){  
	    
        event.preventDefault();
        // Get form
        var form = $('#bankemp')[0];
        
		// Create an FormData object
        var data = new FormData(form);
         
		
		var lnkurl;
        var btnval = $("#subbtn7").val();
		
		
		if(btnval == "Add Account"){
				 lnkurl = "/employees/addbankemp";
				 
	    }
		else{
			     lnkurl = "/employees/editbankemp/" + document.getElementById("idhd1").value;
				 
				
		}
        
        $.ajax({
            type: "POST",
            url: lnkurl,
            data: data,
            processData: false,
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (bankdata) {
           
            successbanktbl(bankdata);
       
        
            },
            error: function (e) {
               
                console.log("ERROR : ", e);
                
            }
        });
	  
	     
		     document.getElementById("bankname").selectedIndex = 0;
			 document.getElementById("baddress").value = "";	 
			 document.getElementById("scode").value = "";	 
			 document.getElementById("ifsccode").value = "";	 
			 document.getElementById("accountno").value = "";	
             document.getElementById('une3').innerHTML = ""; 			 
	         $("#subbtn7").val("Add Account");   
	  }
	  
    });
function successtbl(data1){
		var trHTML = '';
        var tb = document.getElementById('tab1');
		  while(tb.rows.length > 1) {
		  tb.deleteRow(1);
        }
      
          
             for(var i=0; i<data1.length;i++) { 
			 var item = data1[i];
			 
			 var trHTML;
			 document.getElementById("id2").value = item._id;
             trHTML +="<tr>";
			 trHTML +="<td>" + item.country + "</td>";
			 trHTML +="<td>" + item.expirydate + "</td>";
			 trHTML +="<td>" + item.visatype + "</td>";
			 
			 if(item.filename != ""){
			 trHTML +='<td><a href=' + item.filepath + ' target ="_blank">' + item.filename + '</a></td>';
			 }
			 else{trHTML += "<td></td>";}
			 trHTML +="<td>";
			 trHTML +='&nbsp;&nbsp; <a class ="btndelete"><img src="/images/delete.png"></a><input type="hidden" class="itemid" value="'+ item._id +'"/></td>';
			 }  
			
       $('#tab1').append(trHTML);
	   $('.btndelete').on('click', function () {
		 var check = confirm('Are you sure want to inactive this record?');
			 if (check == true) {
			 var itemid = $(this).parent().find('.itemid').val();
			   $.ajax({
				type: "GET",
				url: "/employees/inactivevisa/" + itemid,
				data: {},
				processData: false,
				contentType: false,
				cache: false,
				timeout: 600000,
				success: function (data1) {
						 successtbl(data1);
						 
						 
				},
				error: function (e) {
					   console.log("ERROR : ", e);
				}
			});
			 
			 }
			 else{
			   return false;
			 }
		});
}
function successdoctbl(datadoc){
var trHTML = '';
        var tb = document.getElementById('tab2');
		  while(tb.rows.length > 1) {
		  tb.deleteRow(1);
        }  
       
          
             for(var i=0; i<datadoc.length;i++) { 
			 var item = datadoc[i];
			 var trHTML;
			 document.getElementById("id4").value = item._id;
             trHTML +="<tr>";
			 trHTML +="<td>" + item.documentype + "</td>";
			 if(item.filename != ""){
			 trHTML +='<td><a href=' + item.filepath + ' target ="_blank">' + item.filename + '</a></td>';
			 }
			 else{trHTML += "<td></td>";}
			 trHTML +="<td>";
			 trHTML +='&nbsp;&nbsp; <a class ="btndocdelete"><img src="/images/delete.png"></a><input type="hidden" class="docitemid" value="'+ item._id +'"/></td>';
			 }  
			
       $('#tab2').append(trHTML);
	   $('.btndocdelete').on('click', function () {
		 var check = confirm('Are you sure want to inactive this record?');
			 if (check == true) {
			 var docitemid = $(this).parent().find('.docitemid').val();
			   $.ajax({
				type: "GET",
				url: "/employees/inactivedoc/" + docitemid,
				data: {},
				processData: false,
				contentType: false,
				cache: false,
				timeout: 600000,
				success: function (datadoc) {
						 successdoctbl(datadoc);
						 						 
				},
				error: function (e) {
					   
				}
			});
			 
			 }
			 else{
			   return false;
			 }
		});
}

function successpaysliptbl(datapayslip){


var trHTML = '';
        var tb = document.getElementById('tab4');
		  while(tb.rows.length > 1) {
		  tb.deleteRow(1);
        }  
       
          
             for(var i=0; i<datapayslip.length;i++) { 
			 var item = datapayslip[i];
			 var trHTML;
			
             trHTML +="<tr>";
			 trHTML +="<td>" + item.year + "</td>";
			 trHTML +="<td>" + item.month + "</td>";
			 if(item.filename != ""){
			 trHTML +='<td><a href=' + item.filepath + ' target ="_blank">' + item.filename + '</a></td>';
			 }
			 else{trHTML += "<td></td>";}
			 trHTML +="<td>";
			 trHTML +='<a class ="btnpdelete"><img src="/images/delete.png"></a><input type="hidden" class="itemid" value="'+ item._id +'"/>';
			 
			 }  
			
       $('#tab4').append(trHTML);
	   $('.btnpdelete').on('click', function () {
		 var check = confirm('Are you sure want to inactive this record?');
			 if (check == true) {
			 var itemid = $(this).parent().find('.itemid').val();
			   $.ajax({
				type: "GET",
				url: "/employees/inactivepayslip/" + itemid,
				data: {},
				processData: false,
				contentType: false,
				cache: false,
				timeout: 600000,
				success: function (datapayslip) {
						 successpaysliptbl(datapayslip);
						
				},
				error: function (e) {
					   
				}
			});
			 
			 }
			 else{
			   return false;
			 }
		});
		
		
		
}

function successbanktbl(bankdata){
var trHTML = '';
        var tb = document.getElementById('tab3');
		  while(tb.rows.length > 1) {
		  tb.deleteRow(1);
        }
       
          
             for(var i=0; i<bankdata.length;i++) { 
			 var item = bankdata[i];
			 var trHTML;
			 document.getElementById("id6").value = item._id;
             trHTML +="<tr>";
			 trHTML +="<td>" + item.bankname + "</td>";
			 trHTML +="<td>" + item.ifsccode + "</td>";
			 trHTML +="<td>" + item.accountno + "</td>";
			 trHTML +="<td>";
			  
			 trHTML +='&nbsp;&nbsp; <a class ="btnbankedit"><img src="/images/edit.png"></a><input type="hidden" class="bankitemid" value="'+ item._id +'"/>';
			 trHTML +='&nbsp;&nbsp; <a class ="btnbankdelete"><img src="/images/delete.png"></a><input type="hidden" class="bankitemid" value="'+ item._id +'"/></td>';
			 }  
			
       $('#tab3').append(trHTML);
	   $('.btnbankdelete').on('click', function () {
		 var check = confirm('Are you sure want to inactive this record?');
			 if (check == true) {
			 var bankitemid = $(this).parent().find('.bankitemid').val();
			   $.ajax({
				type: "GET",
				url: "/employees/inactivebank/" + bankitemid,
				data: {},
				processData: false,
				contentType: false,
				cache: false,
				timeout: 600000,
				success: function (databank) {
						 successbanktbl(databank);
						 document.getElementById("bankname").selectedIndex = 0;
						 document.getElementById("baddress").value = "";	 
						 document.getElementById("scode").value = "";	 
						 document.getElementById("ifsccode").value = "";	 
						 document.getElementById("accountno").value = "";	
						 document.getElementById('une3').innerHTML = ""; 			 
						 $("#subbtn7").val("Add Account"); 
				},
				error: function (e) {
					   
				}
			});
			 
			 }
			 else{
			   return false;
			 }
		});
		
		$('.btnbankedit').on('click', function () {
		     
			 
			 var itemid = $(this).parent().find('.bankitemid').val();
			   $.ajax({
				type: "GET",
				url: "/employees/fetchbankemp/" + itemid,
				data: {},
				processData: false,
				contentType: false,
				cache: false,
				timeout: 600000,
				success: function (data1) {
				 var item = data1;
				    $('#idhd1').val(item._id);
					
                    $('#bank').val(item.bankname_id);	
					$('#baddress').val(item.address);	
					$('#officeno').val(item.officeno);	
					$('#scode').val(item.scode);
                    $('#ifsccode').val(item.ifsccode);					
					$('#accountno').val(item.accountno);
                    $("#subbtn7").val('Update Account');					
									
				},
				error: function (e) {

					   console.log("ERROR : ", e);
				}
			});
			 
			 
		});
		
		
}
$('.close').on('click', function () {
		        $.ajax({
				type: "GET",
				url: "/employees",
				data: {},
				processData: false,
				contentType: false,
				cache: false,
				timeout: 600000,
				
				error: function (e) {
					   console.log("ERROR : ", e);
				}
			});
			 
			 
		});
		
		
    $year = $('#year');
    
	
	$year.change(function() {
    
     var tb = document.getElementById('tab4');
		  while(tb.rows.length > 1) {
		  tb.deleteRow(1);
        }
	
	 
     var year = document.getElementById("year").value;
	 var employee_id = document.getElementById("id7").value
	 
	 
        $.ajax({
          method: "GET",
          url: "/employees/returnpayslipemp",
          data: { employee_id: employee_id ,
		          year:year
				},
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          cache: false,
          success: function (payslipdoc) {
            
        
            successpaysliptbl(payslipdoc);
        
        },
       error: function (msg) {
            
            
         }
       });
		  
	
  
	});	

var sortSelect = function (select, attr, order) {
    if(attr === 'text'){
        if(order === 'asc'){
            $(select).html($(select).children('option').sort(function (x, y) {
                return $(x).text().toUpperCase() < $(y).text().toUpperCase() ? -1 : 1;
            }));
            $(select).get(0).selectedIndex = 0;
            
        }// end asc
        if(order === 'desc'){
            $(select).html($(select).children('option').sort(function (y, x) {
                return $(x).text().toUpperCase() < $(y).text().toUpperCase() ? -1 : 1;
            }));
            $(select).get(0).selectedIndex = 0;
            e.preventDefault();
        }// end desc
    }

};
	
$.noConflict();
jQuery( document ).ready(function( $ ) {
    $('#myTable').DataTable();
 $('tr').each(function(){
           if($(this).find('td:last').text().trim() === "Active"){
		   
             
			  
			  $(this).css('background','rgb(114, 171, 220)');
          }
		  if($(this).find('td:last').text().trim() === "Inactive"){
		   
		      $(this).css('background','#BCBABE');
			  }
		 
		  
        });
	
});
 
 
 
 
 
// Code that uses other library's $ can follow here.
</script>

<script src="/javascripts/jquery.3.2.1.min.js" type="text/javascript"></script>
<script src="/javascripts/chartist.min.js"></script>
<script src="/javascripts/bootstrap-notify.js"></script>
<script src="/javascripts/bootstrap.min.js" type="text/javascript"></script>
<!-- <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script> -->
<script src="/javascripts/light-bootstrap-dashboard.js?v=1.4.0"></script>